#' Object that contains results for a single model
#' 
#' @slot signatures A matrix of signatures by mutational motifs
#' @slot exposures A matrix of samples by signature weights
#' @slot num_signatures Number of signatures in the model
#' @slot other_parameters Parameters relevant to the model
#' @slot credible_intervals Credible intervals for parameters
#' @slot metrics Performance metrics for the model
#' @slot umap List of umap data.frames for plotting and analysis
#' @slot model_id Model identifier
#' @slot modality Modality of result (SBS96, DBS78, IND83)
#' @export
#' @exportClass result_model

setClass(
  "result_model",
  slots = list(
    signatures = "matrix",
    exposures = "matrix",
    num_signatures = "numeric",
    other_parameters = "SimpleList",
    credible_intervals = "SimpleList",
    metrics = "SimpleList",
    umap = "matrix",
    model_id = "character",
    modality = "character"
  )
)

#' @title Retrieve exposures from a result_model object
#' @description  The \code{exposure} matrix contains estimated amount of
#' each signature for each sample. Rows correspond to each signature and
#' columns correspond to each sample.
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname exposures
#' @return A matrix of exposures
#' @export
#' @examples
#' data(res)
#' exposures(res)
setGeneric(
  name = "exposures",
  def = function(result)
  {
    standardGeneric("exposures")
  }
)

#' @rdname exposures
setMethod(
  f = "exposures",
  signature = "result_model",
  definition = function(result) {
    return(result@exposures)
  }
)

#' @rdname exposures
setMethod(
  f = "exposures",
  signature = "musica_result",
  definition = function(result) {
    return(result@exposures)
  }
)

#' @rdname exposures
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A matrix of samples by signature exposures
#' @export
#' @examples
#' data(res)
#' exposures(res) <- matrix()
setGeneric(
  name = "exposures<-",
  def = function(result, value)
  {
    standardGeneric("exposures<-")
  }
)

#' @rdname exposures
setReplaceMethod(
  f = "exposures",
  signature = c("result_model", "matrix"),
  definition = function(result, value)
  {
    result@exposures <- value
    return(result)
  }
) 

#' @rdname exposures
setReplaceMethod(
  f = "exposures",
  signature = c("musica_result", "matrix"),
  definition = function(result, value)
  {
    result@exposures <- value
    return(result)
  }
) 

#' @title Retrieve signatures from a result_model object
#' @description  The \code{signature} matrix contains the probability of
#' mutation motif in each sample. Rows correspond to each motif and
#' columns correspond to each signature.
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname signatures
#' @return A matrix of mutational signatures
#' @export
#' @examples
#' data(res)
#' signatures(res)
setGeneric(
  name = "signatures",
  def = function(result)
  {
    standardGeneric("signatures")
  }
)

#' @rdname signatures
setMethod(
  f = "signatures",
  signature = "result_model",
  definition = function(result) {
    return(result@signatures)
  }
)

#' @rdname signatures
setMethod(
  f = "signatures",
  signature = "musica_result",
  definition = function(result) {
    return(result@signatures)
  }
)

#' @rdname signatures
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A matrix of motifs counts by samples
#' @export
#' @examples
#' data(res)
#' signatures(res) <- matrix()
setGeneric(
  name = "signatures<-",
  def = function(result, value)
  {
    standardGeneric("signatures<-")
  }
)

#' @rdname signatures
setReplaceMethod(
  f = "signatures",
  signature = c("result_model", "matrix"),
  definition = function(result, value)
  {
    result@signatures <- value
    return(result)
  }
) 

#' @rdname signatures
setReplaceMethod(
  f = "signatures",
  signature = c("musica_result", "matrix"),
  definition = function(result, value)
  {
    result@signatures <- value
    return(result)
  }
) 

#' @title Retrieve num_signatures from a result_model object
#' @description  The number of signatures in a model
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname num_signatures
#' @return The number of signautres in the model
#' @export
#' @examples
#' data(res)
#' num_signatures(res)
setGeneric(
  name = "num_signatures",
  def = function(result)
  {
    standardGeneric("num_signatures")
  }
)

#' @rdname num_signatures
setMethod(
  f = "num_signatures",
  signature = "result_model",
  definition = function(result) {
    return(result@num_signatures)
  }
)

#' @rdname num_signatures
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value Number of signatures in the model
#' @export
setGeneric(
  name = "num_signatures<-",
  def = function(result, value)
  {
    standardGeneric("num_signatures<-")
  }
)

#' @rdname num_signatures
setReplaceMethod(
  f = "num_signatures",
  signature = c("result_model", "numeric"),
  definition = function(result, value)
  {
    result@num_signatures <- value
    return(result)
  }
) 

#' @title Retrieve other_parameters from a result_model object
#' @description  Parameters for the model
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname other_parameters
#' @return The other parameters for the model
#' @export
#' @examples
#' data(res)
#' other_parameters(res)
setGeneric(
  name = "other_parameters",
  def = function(result)
  {
    standardGeneric("other_parameters")
  }
)

#' @rdname other_parameters
setMethod(
  f = "other_parameters",
  signature = "result_model",
  definition = function(result) {
    return(result@other_parameters)
  }
)

#' @rdname other_parameters
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value List of other parameters
#' @export
setGeneric(
  name = "other_parameters<-",
  def = function(result, value)
  {
    standardGeneric("other_parameters<-")
  }
)

#' @rdname other_parameters
setReplaceMethod(
  f = "other_parameters",
  signature = c("result_model", "SimpleList"),
  definition = function(result, value)
  {
    result@other_parameters <- value
    return(result)
  }
) 

#' @title Retrieve credible_intervals from a result_model object
#' @description  Credible intervals for the model
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname credible_intervals
#' @return The credible intervals for the model
#' @export
#' @examples
#' data(res)
#' credible_intervals(res)
setGeneric(
  name = "credible_intervals",
  def = function(result)
  {
    standardGeneric("credible_intervals")
  }
)

#' @rdname credible_intervals
setMethod(
  f = "credible_intervals",
  signature = "result_model",
  definition = function(result) {
    return(result@credible_intervals)
  }
)

#' @rdname credible_intervals
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value List of credible intervals
#' @export
setGeneric(
  name = "credible_intervals<-",
  def = function(result, value)
  {
    standardGeneric("credible_intervals<-")
  }
)

#' @rdname credible_intervals
setReplaceMethod(
  f = "credible_intervals",
  signature = c("result_model", "SimpleList"),
  definition = function(result, value)
  {
    result@credible_intervals <- value
    return(result)
  }
) 

#' @title Retrieve metrics from a result_model object
#' @description  Metrics for the model
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname metrics
#' @return The metrics for the model
#' @export
#' @examples
#' data(res)
#' metrics(res)
setGeneric(
  name = "metrics",
  def = function(result)
  {
    standardGeneric("metrics")
  }
)

#' @rdname metrics
setMethod(
  f = "metrics",
  signature = "result_model",
  definition = function(result) {
    return(result@metrics)
  }
)

#' @rdname metrics
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value List of metrics
#' @export
setGeneric(
  name = "metrics<-",
  def = function(result, value)
  {
    standardGeneric("metrics<-")
  }
)

#' @rdname metrics
setReplaceMethod(
  f = "metrics",
  signature = c("result_model", "SimpleList"),
  definition = function(result, value)
  {
    result@metrics <- value
    return(result)
  }
) 

#' @title Retrieve umap list from a result_model object
#' @description  The \code{signature} matrix contains the probability of
#' mutation motif in each sample. Rows correspond to each motif and
#' columns correspond to each signature.
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname umap
#' @return A list of umap dataframes
#' @export
#' @examples
#' data(res)
#' umap(res)
setGeneric(
  name = "umap",
  def = function(result)
  {
    standardGeneric("umap")
  }
)

#' @rdname umap
setMethod(
  f = "umap",
  signature = "result_model",
  definition = function(result) {
    return(result@umap)
  }
)

#' @rdname umap
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A list of umap dataframes
#' @export
#' @examples
#' data(res)
#' umap(res) <- matrix()
setGeneric(
  name = "umap<-",
  def = function(result, value)
  {
    standardGeneric("umap<-")
  }
)

#' @rdname umap
setReplaceMethod(
  f = "umap",
  signature = c("result_model", "matrix"),
  definition = function(result, value)
  {
    result@umap <- value
    return(result)
  }
) 

#' @title Retrieve model_id from a result_model object
#' @description  Model identifier
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname model_id
#' @return The model_id for the model
#' @export
#' @examples
#' data(res)
#' model_id(res)
setGeneric(
  name = "model_id",
  def = function(result)
  {
    standardGeneric("model_id")
  }
)

#' @rdname model_id
setMethod(
  f = "model_id",
  signature = "result_model",
  definition = function(result) {
    return(result@model_id)
  }
)

#' @rdname model_id
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value Model identifier
#' @export
setGeneric(
  name = "model_id<-",
  def = function(result, value)
  {
    standardGeneric("model_id<-")
  }
)

#' @rdname model_id
setReplaceMethod(
  f = "model_id",
  signature = c("result_model", "character"),
  definition = function(result, value)
  {
    result@model_id <- value
    return(result)
  }
) 

#' @title Retrieve modality from a result_model object
#' @description  The modality
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @rdname modality
#' @return Modality used for plotting
#' @export
#' @examples
#' data(res)
#' modality(res)
setGeneric(
  name = "modality",
  def = function(result)
  {
    standardGeneric("modality")
  }
)

#' @rdname modality
setMethod(
  f = "modality",
  signature = "result_model",
  definition = function(result) {
    return(result@modality)
  }
)

#' @rdname modality
#' @param result A \code{\linkS4class{result_model}} object generated by
#' a mutational discovery or prediction tool.
#' @param value A modality
#' @export
#' @examples
#' data(res)
#' modality(res) <- "SBS96
setGeneric(
  name = "modality<-",
  def = function(result, value)
  {
    standardGeneric("modality<-")
  }
)

#' @rdname modality
setReplaceMethod(
  f = "modality",
  signature = c("result_model", "character"),
  definition = function(result, value)
  {
    result@modality <- value
    return(result)
  }
) 

